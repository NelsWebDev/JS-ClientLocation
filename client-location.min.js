class ClientLocation{setUserIP(t){this.userIP=t}getUserIp(t){if(this.userIP)return t instanceof Function&&t(this.userIP),this.userIP;let e=new XMLHttpRequest,s=this;e.onreadystatechange=function(e){if(4==this.readyState&&200==this.status){const e=/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/,n=this.responseText.match(e)[0];s.setUserIP(n),t instanceof Function&&t(n)}},e.open("GET","https://www.cloudflare.com/cdn-cgi/trace",!0),e.setRequestHeader("Accept","application/json"),e.send()}setUserLocation(t){this.userLocation=t}getUserLocation(t){let e=this;if(this.userLocation)return t instanceof Function&&t(this.userLocation),this.userLocation;this.getUserIp(function(s){let n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==this.readyState&&200==this.status){let s=JSON.parse(this.responseText);e.setUserLocation(s),t instanceof Function&&t(s)}},n.open("GET","https://ipinfo.io/"+s,!0),n.setRequestHeader("Accept","application/json"),n.send()})}}
